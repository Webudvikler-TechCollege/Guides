# Guide til Cookies i JavaScript 🍪

## Hvad er en cookie?

En **cookie** er en lille tekstfil som din browser gemmer på din computer. Websites bruger cookies til at huske information om dig mellem besøg.

**Eksempler på hvad cookies bruges til:**
- Holde dig logget ind på et website
- Huske din indkøbskurv
- Gemme dine indstillinger (sprog, tema osv.)
- Spore din aktivitet (analysetools)

---

## Sådan fungerer cookies

```
1. Du besøger et website
2. Website sender en cookie til din browser
3. Browser gemmer cookien på din computer
4. Næste gang du besøger websitet, sender browseren cookien tilbage
5. Website kan nu "huske" dig
```

**Vigtigt at vide:**
- Cookies er **kun** tilgængelige for det website der oprettede dem
- Cookies har en **udløbsdato** - derefter slettes de automatisk
- Du kan se og slette cookies i din browser

---

## Arbejde med cookies i JavaScript

### 📝 Oprette en cookie

```javascript
// Simpel cookie (udløber når browseren lukkes)
document.cookie = "username=Peter"

// Cookie med udløbsdato (7 dage)
const expires = new Date()
expires.setTime(expires.getTime() + 7 * 24 * 60 * 60 * 1000) // 7 dage i millisekunder
document.cookie = `username=Peter;expires=${expires.toUTCString()};path=/`
```

**Forklaring:**
- `username=Peter` - navnet og værdien
- `expires=...` - hvornår cookien udløber
- `path=/` - cookien er tilgængelig på hele websitet

---

### 📖 Læse en cookie

```javascript
// Alle cookies returneres som én lang tekst-streng
console.log(document.cookie)
// Output: "brugernavn=Peter; tema=dark; sprog=da"

// For at finde en specifik cookie skal vi parse strengen
function getCookie(name) {
    const nameEQ = name + "="
    const cookies = document.cookie.split(';') // Split ved semikolon
    
    for (let i = 0; i < cookies.length; i++) {
        let cookie = cookies[i].trim() // Fjern mellemrum
        if (cookie.indexOf(nameEQ) === 0) {
            return cookie.substring(nameEQ.length) // Returner værdien
        }
    }
    return null // Cookie ikke fundet
}

// Brug funktionen
const brugernavn = getCookie('username')
console.log(brugernavn) // Output: "Peter"
```

---

### 🗑️ Slette en cookie

```javascript
// Slet en cookie ved at sætte udløbsdato til fortiden
document.cookie = "username=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/"

// Smart funktion til at slette cookies
function deleteCookie(name) {
    document.cookie = `${name}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/`
}

// Brug funktionen
deleteCookie('username')
```

---

## Praktisk eksempel: Login-system

```javascript
// 1. Gem login-token når bruger logger ind
function loginUser(token) {
    const expires = new Date()
    expires.setTime(expires.getTime() + 7 * 24 * 60 * 60 * 1000) // 7 dage
    document.cookie = `login_token=${token};expires=${expires.toUTCString()};path=/`
}

// 2. Tjek om bruger er logget ind
function isLoggedIn() {
    const token = getCookie('login_token')
    return token !== null // True hvis cookie findes
}

// 3. Log bruger ud
function logoutUser() {
    deleteCookie('login_token')
    window.location.href = '/login.html' // Send til login-siden
}

// Brug funktionerne
if (isLoggedIn()) {
    console.log('Velkommen tilbage!')
} else {
    console.log('Du skal logge ind')
}
```

---

## Cookie attributter

### `expires`
Hvornår cookien skal slettes

```javascript
const expires = new Date()
expires.setTime(expires.getTime() + 24 * 60 * 60 * 1000) // 1 dag
document.cookie = `navn=værdi;expires=${expires.toUTCString()}`
```

### `max-age`
Alternativ til `expires` - antal sekunder cookien skal leve

```javascript
document.cookie = "navn=værdi;max-age=86400" // 1 dag (86400 sekunder)
```

### `path`
Hvilke sider cookien er tilgængelig på

```javascript
document.cookie = "navn=værdi;path=/" // Hele websitet
document.cookie = "navn=værdi;path=/admin" // Kun /admin og undersider
```

### `secure`
Cookien sendes kun over HTTPS (sikker forbindelse)

```javascript
document.cookie = "navn=værdi;secure"
```

### `SameSite`
Beskytter mod CSRF-angreb

```javascript
document.cookie = "navn=værdi;SameSite=Strict" // Kun sendt til eget website
document.cookie = "navn=værdi;SameSite=Lax" // Sendes ved normale links
```

---

## Hjælpefunktioner (copy-paste venlige)

```javascript
// Gem cookie
function setCookie(name, value, days = 7) {
    const expires = new Date()
    expires.setTime(expires.getTime() + days * 24 * 60 * 60 * 1000)
    document.cookie = `${name}=${value};expires=${expires.toUTCString()};path=/;SameSite=Strict`
}

// Hent cookie
function getCookie(name) {
    const nameEQ = name + "="
    const cookies = document.cookie.split(';')
    for (let i = 0; i < cookies.length; i++) {
        let cookie = cookies[i].trim()
        if (cookie.indexOf(nameEQ) === 0) {
            return cookie.substring(nameEQ.length)
        }
    }
    return null
}

// Slet cookie
function deleteCookie(name) {
    document.cookie = `${name}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/`
}

// Brug
setCookie('username', 'Peter', 30) // Gem i 30 dage
const navn = getCookie('username') // Hent værdi
deleteCookie('username') // Slet cookie
```

---

## Cookies vs. LocalStorage vs. SessionStorage

| Feature | Cookies | LocalStorage | SessionStorage |
|---------|---------|--------------|----------------|
| **Størrelse** | ~4 KB | ~5-10 MB | ~5-10 MB |
| **Udløber** | Ja (du vælger) | Aldrig | Ved browserluk |
| **Sendes til server** | Ja (automatisk) | Nej | Nej |
| **Bedst til** | Login-tokens | Store data | Midlertidige data |

**Tommelfingerregel:**
- Brug **cookies** til login/authentication
- Brug **localStorage** til at gemme bruger-indstillinger
- Brug **sessionStorage** til midlertidige data i én session

---

## Sikkerhed ⚠️

**Vigtige sikkerhedsregler:**

1. **Gem aldrig passwords i cookies** - kun tokens/session IDs
2. **Brug `SameSite=Strict`** - beskytter mod angreb
3. **Brug `Secure` flag** - kun send over HTTPS
4. **Sæt kort udløbstid** - specielt for login-tokens
5. **Valider altid på server-side** - stol ikke på cookies alene

```javascript
// Sikker cookie til login
function setSecureToken(token) {
    const expires = new Date()
    expires.setTime(expires.getTime() + 24 * 60 * 60 * 1000) // 1 dag
    document.cookie = `auth_token=${token};expires=${expires.toUTCString()};path=/;Secure;SameSite=Strict`
}
```

---

## Opgaver til at øve dig 💪

### Opgave 1: Tema-switcher
Lav en knap der skifter mellem lyst og mørkt tema, og gem valget i en cookie.

### Opgave 2: "Husk mig" checkbox
Lav en login-formular med "Husk mig" checkbox der gemmer brugernavnet i 30 dage.

### Opgave 3: Cookie-banner
Lav en cookie-banner (som alle websites har) der kun vises én gang, og gem brugerens valg.

---

## Debugging tips 🐛

**Se cookies i Chrome DevTools:**
1. Tryk `F12`
2. Gå til `Application` tab
3. Udvid `Cookies` i venstre menu
4. Klik på dit website

**Se cookies i Firefox:**
1. Tryk `F12`
2. Gå til `Storage` tab
3. Udvid `Cookies`

**Test cookie-funktioner i konsollen:**
```javascript
// Opret testcookie
setCookie('test', 'hejsa', 1)

// Læs den
console.log(getCookie('test'))

// Slet den
deleteCookie('test')
```

---

## Resurser 📚

- [MDN Web Docs: Cookies](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies)
- [JavaScript.info: Cookies](https://javascript.info/cookie)

**Held og lykke med cookies!** 🍪