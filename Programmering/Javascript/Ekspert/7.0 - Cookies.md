# Guide til Cookies i JavaScript

## Hvad er en cookie?

En **cookie** er en lille tekstfil som din browser gemmer p친 din computer. Websites bruger cookies til at huske information om dig mellem bes칮g.

**Eksempler p친 hvad cookies bruges til:**
- Holde dig logget ind p친 et website
- Huske din indk칮bskurv
- Gemme dine indstillinger (sprog, tema osv.)
- Spore din aktivitet (analysetools)

---

## S친dan fungerer cookies

```
1. Du bes칮ger et website
2. Website sender en cookie til din browser
3. Browser gemmer cookien p친 din computer
4. N칝ste gang du bes칮ger websitet, sender browseren cookien tilbage
5. Website kan nu "huske" dig
```

**Vigtigt at vide:**
- Cookies er **kun** tilg칝ngelige for det website der oprettede dem
- Cookies har en **udl칮bsdato** - derefter slettes de automatisk
- Du kan se og slette cookies i din browser

---

## Arbejde med cookies i JavaScript

### Oprette en cookie

```javascript
// Simpel cookie (udl칮ber n친r browseren lukkes)
document.cookie = "username=Peter"

// Cookie med udl칮bsdato (7 dage)
const expires = new Date()
expires.setTime(expires.getTime() + 7 * 24 * 60 * 60 * 1000) // 7 dage i millisekunder
document.cookie = `username=Peter;expires=${expires.toUTCString()};path=/`
```

**Forklaring:**
- `username=Peter` - navnet og v칝rdien
- `expires=...` - hvorn친r cookien udl칮ber
- `path=/` - cookien er tilg칝ngelig p친 hele websitet

---

### L칝se en cookie

```javascript
// Alle cookies returneres som 칠n lang tekst-streng
console.log(document.cookie)
// Output: "brugernavn=Peter; tema=dark; sprog=da"

// For at finde en specifik cookie skal vi parse strengen
function getCookie(name) {
    const nameEQ = name + "="
    const cookies = document.cookie.split(';') // Split ved semikolon
    
    for (let i = 0; i < cookies.length; i++) {
        let cookie = cookies[i].trim() // Fjern mellemrum
        if (cookie.indexOf(nameEQ) === 0) {
            return cookie.substring(nameEQ.length) // Returner v칝rdien
        }
    }
    return null // Cookie ikke fundet
}

// Brug funktionen
const brugernavn = getCookie('username')
console.log(brugernavn) // Output: "Peter"
```

---

### Slette en cookie

```javascript
// Slet en cookie ved at s칝tte udl칮bsdato til fortiden
document.cookie = "username=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/"

// Smart funktion til at slette cookies
function deleteCookie(name) {
    document.cookie = `${name}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/`
}

// Brug funktionen
deleteCookie('username')
```

---

## Praktisk eksempel: Login-system

```javascript
// 1. Gem login-token n친r bruger logger ind
function loginUser(token) {
    const expires = new Date()
    expires.setTime(expires.getTime() + 7 * 24 * 60 * 60 * 1000) // 7 dage
    document.cookie = `login_token=${token};expires=${expires.toUTCString()};path=/`
}

// 2. Tjek om bruger er logget ind
function isLoggedIn() {
    const token = getCookie('login_token')
    return token !== null // True hvis cookie findes
}

// 3. Log bruger ud
function logoutUser() {
    deleteCookie('login_token')
    window.location.href = '/login.html' // Send til login-siden
}

// Brug funktionerne
if (isLoggedIn()) {
    console.log('Velkommen tilbage!')
} else {
    console.log('Du skal logge ind')
}
```

---

## Cookie attributter

### `expires`
Hvorn친r cookien skal slettes

```javascript
const expires = new Date()
expires.setTime(expires.getTime() + 24 * 60 * 60 * 1000) // 1 dag
document.cookie = `navn=v칝rdi;expires=${expires.toUTCString()}`
```

### `max-age`
Alternativ til `expires` - antal sekunder cookien skal leve

```javascript
document.cookie = "navn=v칝rdi;max-age=86400" // 1 dag (86400 sekunder)
```

### `path`
Hvilke sider cookien er tilg칝ngelig p친

```javascript
document.cookie = "navn=v칝rdi;path=/" // Hele websitet
document.cookie = "navn=v칝rdi;path=/admin" // Kun /admin og undersider
```

### `secure`
Cookien sendes kun over HTTPS (sikker forbindelse)

```javascript
document.cookie = "navn=v칝rdi;secure"
```

### `SameSite`
Beskytter mod CSRF-angreb

```javascript
document.cookie = "navn=v칝rdi;SameSite=Strict" // Kun sendt til eget website
document.cookie = "navn=v칝rdi;SameSite=Lax" // Sendes ved normale links
```

---

## Hj칝lpefunktioner (copy-paste venlige)

```javascript
// Gem cookie
function setCookie(name, value, days = 7) {
    const expires = new Date()
    expires.setTime(expires.getTime() + days * 24 * 60 * 60 * 1000)
    document.cookie = `${name}=${value};expires=${expires.toUTCString()};path=/;SameSite=Strict`
}

// Hent cookie
function getCookie(name) {
    const nameEQ = name + "="
    const cookies = document.cookie.split(';')
    for (let i = 0; i < cookies.length; i++) {
        let cookie = cookies[i].trim()
        if (cookie.indexOf(nameEQ) === 0) {
            return cookie.substring(nameEQ.length)
        }
    }
    return null
}

// Slet cookie
function deleteCookie(name) {
    document.cookie = `${name}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/`
}

// Brug
setCookie('username', 'Peter', 30) // Gem i 30 dage
const navn = getCookie('username') // Hent v칝rdi
deleteCookie('username') // Slet cookie
```

---

## Cookies vs. LocalStorage vs. SessionStorage

| Feature | Cookies | LocalStorage | SessionStorage |
|---------|---------|--------------|----------------|
| **St칮rrelse** | ~4 KB | ~5-10 MB | ~5-10 MB |
| **Udl칮ber** | Ja (du v칝lger) | Aldrig | Ved browserluk |
| **Sendes til server** | Ja (automatisk) | Nej | Nej |
| **Bedst til** | Login-tokens | Store data | Midlertidige data |

**Tommelfingerregel:**
- Brug **cookies** til login/authentication
- Brug **localStorage** til at gemme bruger-indstillinger
- Brug **sessionStorage** til midlertidige data i 칠n session

---

## Sikkerhed 丘멆잺

**Vigtige sikkerhedsregler:**

1. **Gem aldrig passwords i cookies** - kun tokens/session IDs
2. **Brug `SameSite=Strict`** - beskytter mod angreb
3. **Brug `Secure` flag** - kun send over HTTPS
4. **S칝t kort udl칮bstid** - specielt for login-tokens
5. **Valider altid p친 server-side** - stol ikke p친 cookies alene

```javascript
// Sikker cookie til login
function setSecureToken(token) {
    const expires = new Date()
    expires.setTime(expires.getTime() + 24 * 60 * 60 * 1000) // 1 dag
    document.cookie = `auth_token=${token};expires=${expires.toUTCString()};path=/;Secure;SameSite=Strict`
}
```

---

## Opgaver til at 칮ve dig 游눩

### Opgave 1: Tema-switcher
Lav en knap der skifter mellem lyst og m칮rkt tema, og gem valget i en cookie.

### Opgave 2: "Husk mig" checkbox
Lav en login-formular med "Husk mig" checkbox der gemmer brugernavnet i 30 dage.

### Opgave 3: Cookie-banner
Lav en cookie-banner (som alle websites har) der kun vises 칠n gang, og gem brugerens valg.

---

## Debugging tips 游냍

**Se cookies i Chrome DevTools:**
1. Tryk `F12`
2. G친 til `Application` tab
3. Udvid `Cookies` i venstre menu
4. Klik p친 dit website

**Se cookies i Firefox:**
1. Tryk `F12`
2. G친 til `Storage` tab
3. Udvid `Cookies`

**Test cookie-funktioner i konsollen:**
```javascript
// Opret testcookie
setCookie('test', 'hejsa', 1)

// L칝s den
console.log(getCookie('test'))

// Slet den
deleteCookie('test')
```
---

## Resurser

- [MDN Web Docs: Cookies](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies)
- [JavaScript.info: Cookies](https://javascript.info/cookie)